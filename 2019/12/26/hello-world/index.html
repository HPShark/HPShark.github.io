<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>hexo博客上线 | Happy Shark</title><meta name="keywords" content="hexo,travis CI,serverless,语雀"><meta name="author" content="HPShark"><meta name="copyright" content="HPShark"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="博客又双叒叕上线了，这次使用的是hexo + Github Pages + travis CI + 语雀 + serverless + onedrive图床，部署完成之后可以直接在语雀上编辑文章然后自动发布到博客，云端写作不是梦hhh   部署 部署部分是按照博客https:&#x2F;&#x2F;www.simon96.online&#x2F;2018&#x2F;10&#x2F;12&#x2F;hexo-tutorial&#x2F; 配置的，仅做备份之用以便日后">
<meta property="og:type" content="article">
<meta property="og:title" content="hexo博客上线">
<meta property="og:url" content="https://www.happyshark.cn/2019/12/26/hello-world/index.html">
<meta property="og:site_name" content="Happy Shark">
<meta property="og:description" content="博客又双叒叕上线了，这次使用的是hexo + Github Pages + travis CI + 语雀 + serverless + onedrive图床，部署完成之后可以直接在语雀上编辑文章然后自动发布到博客，云端写作不是梦hhh   部署 部署部分是按照博客https:&#x2F;&#x2F;www.simon96.online&#x2F;2018&#x2F;10&#x2F;12&#x2F;hexo-tutorial&#x2F; 配置的，仅做备份之用以便日后">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://qjtsaw.ch.files.1drv.com/y4mpMLII6Wtosqm5wWqSXPsGV1cu9oGQFY9odVJFGOxTdiN8c6FvJnIoHpEIfIt7RiEFrhRMqtfAvwmWCbWKBe3t3aT4DH_JvOOqeDzKQVsUUyhcb6lWIAcaFY4qZew4qh7PY060s8urZiFhrwDDbnzTFXykibC71Aap10ceNza_bkL84zoNkY0AKGhzGSZVYjf4xY_6S7eb0YCfuN4I_mG7Q?width=906&height=966&cropmode=none">
<meta property="article:published_time" content="2019-12-26T06:00:00.000Z">
<meta property="article:modified_time" content="2021-12-24T07:22:08.722Z">
<meta property="article:author" content="HPShark">
<meta property="article:tag" content="hexo">
<meta property="article:tag" content="travis CI">
<meta property="article:tag" content="serverless">
<meta property="article:tag" content="语雀">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://qjtsaw.ch.files.1drv.com/y4mpMLII6Wtosqm5wWqSXPsGV1cu9oGQFY9odVJFGOxTdiN8c6FvJnIoHpEIfIt7RiEFrhRMqtfAvwmWCbWKBe3t3aT4DH_JvOOqeDzKQVsUUyhcb6lWIAcaFY4qZew4qh7PY060s8urZiFhrwDDbnzTFXykibC71Aap10ceNza_bkL84zoNkY0AKGhzGSZVYjf4xY_6S7eb0YCfuN4I_mG7Q?width=906&height=966&cropmode=none"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/hexo/favicon.ico"><link rel="canonical" href="https://www.happyshark.cn/2019/12/26/hello-world/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//pingjs.qq.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="baidu-site-verification" content="http://data.zz.baidu.com/urls?site=https://www.happyshark.cn&amp;token=SoQqqYx4asw1Hjo3"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?5fb1b716f40cab42e95bf5d2d279dd42";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-116830180-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-116830180-1');
</script><script>var _mtac = {};
(function() {
    var mta = document.createElement("script");
    mta.src = "//pingjs.qq.com/h5/stats.js?v2.0.4";
    mta.setAttribute("name", "MTAH5");
    mta.setAttribute("sid", "66503250");
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(mta, s);
})();
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"这篇文章发布于","messageNext":"天之前，文章中的部分内容可能会过期。"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'hexo博客上线',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-12-24 15:22:08'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    document.addEventListener('pjax:complete', detectApple)})(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Happy Shark" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/hexo/avatar.png" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/hexo/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 生活清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://qjtsaw.ch.files.1drv.com/y4mpMLII6Wtosqm5wWqSXPsGV1cu9oGQFY9odVJFGOxTdiN8c6FvJnIoHpEIfIt7RiEFrhRMqtfAvwmWCbWKBe3t3aT4DH_JvOOqeDzKQVsUUyhcb6lWIAcaFY4qZew4qh7PY060s8urZiFhrwDDbnzTFXykibC71Aap10ceNza_bkL84zoNkY0AKGhzGSZVYjf4xY_6S7eb0YCfuN4I_mG7Q?width=906&amp;height=966&amp;cropmode=none')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Happy Shark</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 生活清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">hexo博客上线</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2019-12-26T06:00:00.000Z" title="发表于 2019-12-26 14:00:00">2019-12-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-12-24T07:22:08.722Z" title="更新于 2021-12-24 15:22:08">2021-12-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%8D%9A%E5%AE%A2/">博客</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>25分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="hexo博客上线"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/12/26/hello-world/#post-comment"><span class="gitalk-comment-count"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>博客又双叒叕上线了，这次使用的是hexo + Github Pages + travis CI + 语雀 + serverless + onedrive图床，部署完成之后可以直接在语雀上编辑文章然后自动发布到博客，云端写作不是梦hhh </p>
</blockquote>
<h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><blockquote>
<p>部署部分是按照博客<a target="_blank" rel="noopener" href="https://www.simon96.online/2018/10/12/hexo-tutorial/">https://www.simon96.online/2018/10/12/hexo-tutorial/</a> 配置的，仅做备份之用以便日后博客迁移可以照着这篇文文章重新恢复(ಥ _ ಥ)</p>
</blockquote>
<p>本地环境：windows Linux Ubuntu 18.04</p>
<h2 id="（可选）配置git"><a href="#（可选）配置git" class="headerlink" title="（可选）配置git"></a>（可选）配置git</h2><p>首先我得重新在git设置一下身份的名字和邮箱（因为当初都忘了设置啥了，因为遇到坑了）进入到需要提交的文件夹底下（因为直接打开git Bash，在没有路径的情况下，根本没！法！改！刚使用git时遇到的坑。。。）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;yourname&quot;</span><br><span class="line">git config --global user.email“your@email.com&quot;</span><br></pre></td></tr></table></figure>
<p>注：yourname是你要设置的名字，your@email是你要设置的邮箱。</p>
<h2 id="安装-Node-js和npm"><a href="#安装-Node-js和npm" class="headerlink" title="安装 Node.js和npm"></a>安装 Node.js和npm</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install nodejs</span><br><span class="line">sudo apt-get install npm</span><br></pre></td></tr></table></figure>
<p>如果报错,请更改软件源—清华大学开源软件源,并更新</p>
<p>注：查看nodejs和npm版本号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nodejs -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure>
<p>可以正常打印版本号说明,安装成功</p>
<h2 id="安装-Hexo"><a href="#安装-Hexo" class="headerlink" title="安装 Hexo"></a>安装 Hexo</h2><ol>
<li><p>创建博客所在目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir hexo </span><br></pre></td></tr></table></figure>
</li>
<li><p>创建目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir hexo</span><br></pre></td></tr></table></figure>
</li>
<li><p>切换目录</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd hexo</span><br></pre></td></tr></table></figure>
</li>
<li><p>全局安装 Hexo，需要最高权限，记得输入root密码</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install -g hexo-cli</span><br></pre></td></tr></table></figure>
</li>
<li><p>初始化 Hexo</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br></pre></td></tr></table></figure>
<p> 注：如果报错执行代码,不报错忽略</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo npm config set user 0</span><br><span class="line">sudo npm config set unsafe-perm true</span><br><span class="line">sudo npm install -g hexo-cli</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h2><ol>
<li><p>如果安装慢就安装proxychains，并且定义alias npm=’proxychains4 npm’</p>
</li>
<li><p>如果要永久定义（重启不失效的话就编辑：</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bashrc</span><br></pre></td></tr></table></figure>
<p>   并且在末尾添加以下代码并定义 alias</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alias npm=&#x27;proxychains4 npm&#x27;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置完代理后就可以安装npm插件了</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save</span><br><span class="line">npm install hexo-generator-index --save</span><br><span class="line">npm install hexo-generator-archive --save</span><br><span class="line">npm install hexo-generator-category --save</span><br><span class="line">npm install hexo-generator-tag --save</span><br><span class="line">npm install hexo-server --save</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line">npm install hexo-deployer-heroku --save</span><br><span class="line">npm install hexo-deployer-rsync --save</span><br><span class="line">npm install hexo-deployer-openshift --save</span><br><span class="line">npm install hexo-renderer-marked --save</span><br><span class="line">npm install hexo-renderer-stylus --save</span><br><span class="line">npm install hexo-generator-feed --save</span><br><span class="line">npm install hexo-generator-sitemap --save</span><br><span class="line">npm install hexo-tag-aplayer --save</span><br><span class="line">npm install aplayer --save</span><br><span class="line">npm i --save hexo-wordcount</span><br><span class="line">npm install aplayer --save</span><br><span class="line">npm install --save hexo-helper-live2d</span><br><span class="line">    </span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="测试安装成功"><a href="#测试安装成功" class="headerlink" title="测试安装成功"></a>测试安装成功</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g &amp;&amp; hexo server</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/HPShark/blogimages/master/hello-world/部署成功.png" alt="本地部署成功"></p>
<h1 id="同步到githubpages"><a href="#同步到githubpages" class="headerlink" title="同步到githubpages"></a>同步到githubpages</h1><h2 id="方案一：GithubPages"><a href="#方案一：GithubPages" class="headerlink" title="方案一：GithubPages"></a>方案一：GithubPages</h2><ol>
<li><p>创建<a target="_blank" rel="noopener" href="https://github.com/">Github</a>账号</p>
</li>
<li><p>创建仓库， 仓库名为：<Github账号名称>.github.io</p>
</li>
<li><p>将本地Hexo博客推送到GithubPages</p>
<ul>
<li><p>安装hexo-deployer-git插件。在命令行（即Git Bash）运行以下命令即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加SSH key。</p>
<p>创建一个 SSH key 。在命令行（即Git Bash）输入以下命令，     回车三下即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -C &quot;邮箱地址&quot;  </span><br></pre></td></tr></table></figure>
</li>
<li><p>添加到 github。 复制密钥文件内容（路径形如C:\Users\Administrator.ssh\id_rsa.pub），粘贴到<a target="_blank" rel="noopener" href="https://github.com/settings/keys">New SSH Key</a>即可。</p>
</li>
<li><p>测试是否添加成功。在命令行（即Git     Bash）依次输入以下命令，返回“You’ve successfully authenticated”即成功：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -T git@github.com  </span><br><span class="line">$ yes  </span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>修改_config.yml（在站点目录下）。文件末尾修改为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Deployment  </span><br><span class="line">  ## Docs: https://hexo.io/docs/deployment.html  </span><br><span class="line">  deploy:  </span><br><span class="line">  	type: git  </span><br><span class="line">  	repo: git@github.com:&lt;Github账号名称&gt;/&lt;Github账号名称&gt;.github.io.git  </span><br><span class="line">  	branch: master  </span><br></pre></td></tr></table></figure>
<p>注意：上面仓库地址写ssh地址，不写http地址。(windows使用git的话建议用https，可以挂代理)</p>
</li>
<li><p>推送到GithubPages。在命令行（即Git Bash）依次输入以下命令， 返回INFO Deploy done: git即成功推送：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g  </span><br><span class="line">$ hexo d  </span><br></pre></td></tr></table></figure>
</li>
<li><p>等待1分钟左右，浏览器访问网址：https://<github账号名称>.github.io</p>
</li>
</ol>
<p>至此，的Hexo博客已经搭建在GithubPages, 域名为https://<Github账号名称>.github.io。</p>
<h2 id="方案二：GithubPages-域名"><a href="#方案二：GithubPages-域名" class="headerlink" title="方案二：GithubPages + 域名"></a>方案二：GithubPages + 域名</h2><p>在方案一的基础上，添加自定义域名（购买的域名）。</p>
<ol>
<li><p>域名解析。</p>
<pre><code>类型选择为 CNAME；
主机记录即域名前缀，填写为www；
记录值填写为&lt;Github账号名称&gt;.github.io；
解析线路，TTL 默认即可。
</code></pre></li>
<li><p>仓库设置。</p>
<ul>
<li>打开博客仓库设置：<a target="_blank" rel="noopener" href="https://github.com/">https://github.com/</a><Github账号名称>/<Github账号名称>.github.io/settings</li>
<li>在Custom domain下，填写自定义域名，点击save。</li>
<li>在站点目录的source文件夹下，创建并打开CNAME.txt，写入你的域名，保存，并重命名为CNAME。 </li>
</ul>
</li>
<li><p>等待10分钟左右。</p>
<pre><code>浏览器访问自定义域名。
至此，Hexo博客已经解析到自定义域名，https://&lt;Github账号名称&gt;.github.io依然可用。
</code></pre></li>
</ol>
<h1 id="主题，插件配置"><a href="#主题，插件配置" class="headerlink" title="主题，插件配置"></a>主题，插件配置</h1><h2 id="主题"><a href="#主题" class="headerlink" title="主题"></a>主题</h2><p>hexo博客主题用的是<a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">butterfly</a>，配置信息：<a target="_blank" rel="noopener" href="https://jerryc.me/posts/21cfbf15/">https://jerryc.me/posts/21cfbf15/</a> ，感谢作者~</p>
<h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><blockquote>
<p>插件部分引自博客<a target="_blank" rel="noopener" href="https://www.simon96.online/2018/10/12/hexo-tutorial/">https://www.simon96.online/2018/10/12/hexo-tutorial/</a> ，仅做备份之用以便日后博客迁移可以照着这篇文文章重新恢复(ಥ _ ಥ)</p>
</blockquote>
<h3 id="live2d"><a href="#live2d" class="headerlink" title="live2d"></a>live2d</h3><ul>
<li><p>安装插件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-helper-live2d</span><br></pre></td></tr></table></figure>
</li>
<li><p>复制你喜欢的模型名字：</p>
<p> Epsilon2.1</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/Epsilon2.1.gif"><img src="https://huaji8.top/img/live2d/Epsilon2.1.gif" alt="img"></a></p>
<p> Gantzert_Felixander</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/Gantzert_Felixander.gif"><img src="https://huaji8.top/img/live2d/Gantzert_Felixander.gif" alt="img"></a></p>
<p> haru</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/haru.gif"><img src="https://huaji8.top/img/live2d/haru.gif" alt="img"></a></p>
<p> miku</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/miku.gif"><img src="https://huaji8.top/img/live2d/miku.gif" alt="img"></a></p>
<p> ni-j</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/ni-j.gif"><img src="https://huaji8.top/img/live2d/ni-j.gif" alt="img"></a></p>
<p> nico</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/nico.gif"><img src="https://huaji8.top/img/live2d/nico.gif" alt="img"></a></p>
<p> nietzche</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/nietzche.gif"><img src="https://huaji8.top/img/live2d/nietzche.gif" alt="img"></a></p>
<p> nipsilon</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/nipsilon.gif"><img src="https://huaji8.top/img/live2d/nipsilon.gif" alt="img"></a></p>
<p> nito</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/nito.gif"><img src="https://huaji8.top/img/live2d/nito.gif" alt="img"></a></p>
<p> shizuku</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/shizuku.gif"><img src="https://huaji8.top/img/live2d/shizuku.gif" alt="img"></a></p>
<p> tsumiki</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/tsumiki.gif"><img src="https://huaji8.top/img/live2d/tsumiki.gif" alt="img"></a></p>
<p> wanko</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/wanko.gif"><img src="https://huaji8.top/img/live2d/wanko.gif" alt="img"></a></p>
<p> z16</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/z16.gif"><img src="https://huaji8.top/img/live2d/z16.gif" alt="img"></a></p>
<p> hibiki</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/hibiki.gif"><img src="https://huaji8.top/img/live2d/hibiki.gif" alt="img"></a></p>
<p> koharu</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/koharu.gif"><img src="https://huaji8.top/img/live2d/koharu.gif" alt="img"></a></p>
<p> haruto</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/haruto.gif"><img src="https://huaji8.top/img/live2d/haruto.gif" alt="img"></a></p>
<p> Unitychan</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/Unitychan.gif"><img src="https://huaji8.top/img/live2d/Unitychan.gif" alt="img"></a></p>
<p> tororo</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/tororo.gif"><img src="https://huaji8.top/img/live2d/tororo.gif" alt="img"></a></p>
<p> hijiki</p>
<p> <a target="_blank" rel="noopener" href="https://huaji8.top/img/live2d/hijiki.gif"><img src="https://huaji8.top/img/live2d/hijiki.gif" alt="img"></a></p>
</li>
<li><p>将以下代码添加到主题配置文件<code>_config.yml</code>，修改&lt;你喜欢的模型名字&gt;：</p>
 <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">live2d:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">scriptFrom:</span> <span class="string">local</span></span><br><span class="line">  <span class="attr">pluginRootPath:</span> <span class="string">live2dw/</span></span><br><span class="line">  <span class="attr">pluginJsPath:</span> <span class="string">lib/</span></span><br><span class="line">  <span class="attr">pluginModelPath:</span> <span class="string">assets/</span></span><br><span class="line">  <span class="attr">tagMode:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">log:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">model:</span></span><br><span class="line">    <span class="attr">use:</span> <span class="string">live2d-widget-model-hijiki</span></span><br><span class="line">  <span class="attr">display:</span></span><br><span class="line">    <span class="attr">position:</span> <span class="string">right</span></span><br><span class="line">    <span class="attr">width:</span> <span class="number">150</span></span><br><span class="line">    <span class="attr">height:</span> <span class="number">300</span></span><br><span class="line">  <span class="attr">mobile:</span></span><br><span class="line">    <span class="attr">show:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">react:</span></span><br><span class="line">    <span class="attr">opacity:</span> <span class="number">0.7</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>建配置文件</p>
<ul>
<li><p>在站点目录下建文件夹<code>live2d_models</code>，</p>
</li>
<li><p>再在<code>live2d_models</code>下建文件夹<code>&lt;你喜欢的模型名字&gt;</code>,</p>
</li>
<li><p>再在<code>&lt;你喜欢的模型名字&gt;</code>下建json文件：&lt;你喜欢的模型名字&gt;.model.json</p>
</li>
</ul>
</li>
<li><p>安装模型。在命令行（即Git Bash）运行以下命令即可：</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save live2d-widget-model-hijiki</span><br></pre></td></tr></table></figure>
</li>
<li><p>在命令行（即Git Bash）运行以下命令， 在<code>http://127.0.0.1:4000/</code>查看测试结果:</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="评论插件（2021年9月12日更新）"><a href="#评论插件（2021年9月12日更新）" class="headerlink" title="评论插件（2021年9月12日更新）"></a>评论插件（2021年9月12日更新）</h3><ul>
<li>博客评论采用gitalk，配置过程参考<a target="_blank" rel="noopener" href="https://github.com/gitalk/gitalk/blob/master/readme-cn.md">https://github.com/gitalk/gitalk/blob/master/readme-cn.md</a></li>
<li>创建 <strong>GitHub Application</strong>的时候需要注意一下，url填个人博客的完整地址。</li>
</ul>
<h1 id="进阶配置"><a href="#进阶配置" class="headerlink" title="进阶配置"></a>进阶配置</h1><h2 id="github-actions自动构建（2021年9月12日更新）"><a href="#github-actions自动构建（2021年9月12日更新）" class="headerlink" title="github actions自动构建（2021年9月12日更新）"></a>github actions自动构建（2021年9月12日更新）</h2><p>由于不经常用语雀（就是懒），再加上travis ci要求构建的库必须是公共库，所以转战github actions。</p>
<ul>
<li><p>创建 <code>blog</code> 仓库用来存放 Hexo 项目</p>
</li>
<li><p>创建 <code>your.github.io</code> 仓库用来存放静态博客页面</p>
</li>
</ul>
<ol>
<li><p>生成ssh密钥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -f github-deploy-key</span><br></pre></td></tr></table></figure>
<p>会生成 <code>github-deploy-key</code> 和 <code>github-deploy-key.pub</code> 两个文件。</p>
</li>
<li><p>配置部署密钥</p>
<p>复制 <code>github-deploy-key</code> 文件内容，在 <code>blog</code> 仓库 <code>Settings -&gt; Secrets -&gt; Add a new secret</code> 页面上添加。</p>
<ul>
<li>在 <code>Name</code> 输入框填写 <code>HEXO_DEPLOY_PRI</code>。</li>
<li>在 <code>Value</code> 输入框填写 <code>github-deploy-key</code> 文件内容。</li>
</ul>
<p>复制 <code>github-deploy-key.pub</code> 文件内容，在 <code>your.github.io</code> 仓库 <code>Settings -&gt; Deploy keys -&gt; Add deploy key</code> 页面上添加。</p>
<ul>
<li><p>在 <code>Title</code> 输入框填写 <code>HEXO_DEPLOY_PUB</code>。</p>
</li>
<li><p>在 <code>Key</code> 输入框填写 <code>github-deploy-key.pub</code> 文件内容。</p>
</li>
<li><p>勾选 <code>Allow write access</code> 选项。</p>
</li>
</ul>
</li>
<li><p>编写 Github Actions</p>
<p><strong>Workflow 模版</strong></p>
<p>3.1 在 <code>blog</code> 仓库根目录下创建 <code>.github/workflows/deploy.yml</code> 文件，目录结构如下。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">blog (repository)</span><br><span class="line">└── .github</span><br><span class="line">    └── workflows</span><br><span class="line">        └── deploy.yml</span><br></pre></td></tr></table></figure>
<p>3.2 </p>
<p>在 <code>deploy.yml</code> 文件中粘贴以下内容。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">name: CI</span><br><span class="line"></span><br><span class="line">on:</span><br><span class="line">  push:</span><br><span class="line">    branches:</span><br><span class="line">      - master</span><br><span class="line"></span><br><span class="line">env:</span><br><span class="line">  GIT_USER: HPShark</span><br><span class="line">  GIT_EMAIL: www.yaoyuchao@qq.com</span><br><span class="line">  THEME_REPO: HPShark/happyshark</span><br><span class="line">  THEME_BRANCH: master</span><br><span class="line">  DEPLOY_REPO: HPShark/HPShark.github.io</span><br><span class="line">  DEPLOY_BRANCH: master</span><br><span class="line"></span><br><span class="line">jobs:</span><br><span class="line">  build:</span><br><span class="line">    name: Build on node $&#123;&#123; matrix.node_version &#125;&#125; and $&#123;&#123; matrix.os &#125;&#125;</span><br><span class="line">    runs-on: ubuntu-latest</span><br><span class="line">    strategy:</span><br><span class="line">      matrix:</span><br><span class="line">        os: [ubuntu-latest]</span><br><span class="line">        node_version: [14.x]</span><br><span class="line"></span><br><span class="line">    steps:</span><br><span class="line">      - name: Checkout</span><br><span class="line">        uses: actions/checkout@v2</span><br><span class="line"></span><br><span class="line">      - name: Checkout theme repo</span><br><span class="line">        uses: actions/checkout@v2</span><br><span class="line">        with:</span><br><span class="line">          repository: $&#123;&#123; env.THEME_REPO &#125;&#125;</span><br><span class="line">          ref: $&#123;&#123; env.THEME_BRANCH &#125;&#125;</span><br><span class="line">          path: themes/concise</span><br><span class="line"></span><br><span class="line">      - name: Checkout deploy repo</span><br><span class="line">        uses: actions/checkout@v2</span><br><span class="line">        with:</span><br><span class="line">          repository: $&#123;&#123; env.DEPLOY_REPO &#125;&#125;</span><br><span class="line">          ref: $&#123;&#123; env.DEPLOY_BRANCH &#125;&#125;</span><br><span class="line">          path: .deploy_git</span><br><span class="line"></span><br><span class="line">      - name: Use Node.js $&#123;&#123; matrix.node_version &#125;&#125;</span><br><span class="line">        uses: actions/setup-node@v1</span><br><span class="line">        with:</span><br><span class="line">          node-version: $&#123;&#123; matrix.node_version &#125;&#125;</span><br><span class="line"></span><br><span class="line">      - name: Configuration environment</span><br><span class="line">        env:</span><br><span class="line">          HEXO_DEPLOY_PRI: $&#123;&#123;secrets.HEXO_DEPLOY_PRI&#125;&#125;</span><br><span class="line">        run: |</span><br><span class="line">          sudo timedatectl set-timezone &quot;Asia/Shanghai&quot;</span><br><span class="line">          mkdir -p ~/.ssh/</span><br><span class="line">          echo &quot;$HEXO_DEPLOY_PRI&quot; &gt; ~/.ssh/id_rsa</span><br><span class="line">          chmod 600 ~/.ssh/id_rsa</span><br><span class="line">          ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts</span><br><span class="line">          git config --global user.name $GIT_USER</span><br><span class="line">          git config --global user.email $GIT_EMAIL</span><br><span class="line"></span><br><span class="line">      - name: Install dependencies</span><br><span class="line">        run: |</span><br><span class="line">          npm install</span><br><span class="line"></span><br><span class="line">      - name: Deploy hexo</span><br><span class="line">        run: |</span><br><span class="line">          npm run deploy</span><br></pre></td></tr></table></figure>
<p><code>name</code> 是当前 Action 的名字，最后你可以在仓库的 Actions 菜单项中看到它。<br><code>on</code>是此 Action 触发条件，当满足条件时会触发此任务，上面的 on.push.branches.source-<code>action</code> 是指当 source-action 分支收到 push 后会触发 Action 执行任务。<br><code>env</code>为环境变量对象</p>
<ul>
<li><p><code>env.GIT_USER</code>为 Hexo 编译后使用此 git 用户部署到仓库</p>
</li>
<li><p><code>env.GIT_EMAIL</code> 为 Hexo 编译后使用此 git 邮箱部署到仓库</p>
</li>
<li><code>env.THEME_REPO</code> 为 Hexo 所使用的主题的仓库，这里为 vensing/Kratos-Rebirth</li>
<li><code>env.THEME_BRANCH</code> 为 Hexo 所使用的主题仓库的版本，可以是：branch、tag 或者 SHA</li>
<li><code>env.DEPLOY_REPO</code>为 Hexo 编译后要部署的仓库，例如：vensing/vensing.github.io</li>
<li><code>env.DEPLOY_BRANCH</code> 为 Hexo 编译后要部署到的分支，例如：master</li>
</ul>
<p><code>jobs</code> 为此 Action 下的任务列表</p>
<ul>
<li><code>jobs.&#123;job&#125;.name</code> 任务名称</li>
<li><code>jobs.&#123;job&#125;.runs-on</code>任务所需容器，可选值：ubuntu-latest、windows-latest、macos-latest。</li>
<li><code>jobs.&#123;job&#125;.strategy</code> 策略下可以写 array 格式，此 job 会遍历此数组执行。</li>
<li><p><code>jobs.&#123;job&#125;.steps</code> 一个步骤数组，可以把所要干的事分步骤放到这里。</p>
<ul>
<li><p><code>jobs.&#123;job&#125;.steps.$.name</code> 步骤名，编译时会会以 LOG 形式输出。</p>
</li>
<li><p><code>jobs.&#123;job&#125;.steps.$.uses</code>所要调用的 Action，可以到 <a target="_blank" rel="noopener" href="https://github.com/actions">https://github.com/actions</a> 查看更多。</p>
</li>
<li><p><code>jobs.&#123;job&#125;.steps.$.with</code>一个对象，调用 Action 传的参数，具体可以查看所使用 Action 的说明。</p>
</li>
</ul>
</li>
</ul>
<p>在上面配置文件中的代码段，指定了 Action 依赖的 OS 实例为 ubuntu-latest，以及 node 运行环境版本为 14.x，任务 steps 中引用了一个 版本为 v2 的 Action checkout ，actions/checkout@v2 的作用是 Checkout 一个 git 仓库到当前 ubuntu 容器。</p>
<ul>
<li>Checkout theme repo step 中从环境变量中拿出 $ 指定本站使用的博客仓库名及分支 hexo5-custom，检出到 themes/Kratos-Rebirth 目录下。</li>
<li>Checkout deploy repo step 中从环境变量中拿出 $ 指定部署备份的博客仓库，及要部署备份生成的静态网页的分支 master，检出到 .deploy_git 目录下。</li>
<li>Use Node.js step 中使用了 actions/setup-node@v1 action 指定了 node 的版本。</li>
</ul>
<p>检出主题分支和 Github Pages 部署分支之后，接着配置执行环境：</p>
<ul>
<li>设置容器的时区；</li>
<li>将在 Settings -&gt; Secrets 中的 SSH 私钥写入到 ~/.ssh/id_rsa 文件中；</li>
<li>设置 id_rsa 的文件权限及 know_hosts、git 全局用户信息</li>
</ul>
<p>接着执行 npm install 安装依赖和 npm run deploy 部署到 Github Pages 进行备份。run: | 可分行连续执行多条命令，需要注意的是使用 hexo 的 deploy 命令需要我们安装 hexo-deployer-git 依赖，所以需要先在本地安装下依赖写入 package.json 中。</p>
</li>
<li><p>执行任务</p>
<p>写一篇文章，<code>push</code> 到 <code>blog</code> 仓库的 <code>master</code> 分支，在此仓库 <code>Actions</code> 页面查看当前 task。</p>
</li>
</ol>
<h2 id="语雀云端写作-腾讯云serverless提交-Travis-ci自动构建-github-pages发布"><a href="#语雀云端写作-腾讯云serverless提交-Travis-ci自动构建-github-pages发布" class="headerlink" title="语雀云端写作+腾讯云serverless提交+ Travis-ci自动构建+github-pages发布"></a>语雀云端写作+腾讯云serverless提交+ Travis-ci自动构建+github-pages发布</h2><blockquote>
<p>实现语雀云端协作部分引自博客<a target="_blank" rel="noopener" href="https://www.itfanr.cc/2017/08/09/using-travis-ci-automatic-deploy-hexo-blogs/">https://www.itfanr.cc/2017/08/09/using-travis-ci-automatic-deploy-hexo-blogs/</a> 以及<a target="_blank" rel="noopener" href="https://aqpcet.coding.me/%E8%AF%AD%E9%9B%80+TravisCI+Serverless/3689364350.html">https://aqpcet.coding.me/%E8%AF%AD%E9%9B%80+TravisCI+Serverless/3689364350.html</a> ，仅做备份之用以便日后博客迁移可以照着这篇文文章重新恢复(ಥ _ ಥ)</p>
</blockquote>
<ul>
<li><p>语雀</p>
<p><a target="_blank" rel="noopener" href="https://yuque.com/">语雀</a>是阿里巴巴旗下的专业云端知识库，支持<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/markdown/3245829?fr=aladdin">Markdown</a>语法，个人和团队皆可用于文档编写。它不仅仅是一个在线编写文档的工具，还集成了<a target="_blank" rel="noopener" href="https://www.yuque.com/yuque/developer/doc-webhook">Web Hook</a> ，为自动化部署Hexo建立了基础。而<a target="_blank" rel="noopener" href="https://github.com/x-cold/yuque-hexo">yuque-hexo</a>是<a target="_blank" rel="noopener" href="https://github.com/x-cold">x-cold</a>根据语雀的API为Hexo博客写的插件，可以很方便的将语雀指定知识库里的文章全部更新到hexo博客中。</p>
</li>
</ul>
<ul>
<li><p>Travis CI</p>
<p><a target="_blank" rel="noopener" href="https://travis-ci.com/">Travis CI</a>可以很方便地将<a target="_blank" rel="noopener" href="https://github.com/">GitHub</a>的项目持续集成并构建。</p>
</li>
</ul>
<ul>
<li><p>Serverless</p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1200169">Serverless</a>可以通过代码唤起Travis CI执行构建项目。</p>
</li>
</ul>
<p>自动部署总体流程如下。</p>
<p><img src="https://raw.githubusercontent.com/HPShark/blogimages/master/hello-world/部署流程.png" alt="图片来自aqpcet.coding.me"></p>
<h3 id="关键文件："><a href="#关键文件：" class="headerlink" title="关键文件："></a>关键文件：</h3><ul>
<li><p>.travis.yml：（参考自<a target="_blank" rel="noopener" href="https://www.itfanr.cc/2017/08/09/using-travis-ci-automatic-deploy-hexo-blogs/">IT范儿</a>）</p>
<p>如果使用这两个问卷配置travis-ci的话，travis-ci.com上仓库的设置里面环境变量只需要设置Travis_Token，变量值为github上取得的Token（DISPLAY VALUE IN BUILD LOG一定要关上！）</p>
</li>
</ul>
<p>  <strong>20200324更新：语雀会对频繁调用的请求进行限流，故需要将语雀token加入到该文件中。${YUQUE_TOKEN}即为语雀token，为保证安全故将token值加进travic网站中而不保存在文件中，添加方法与Travis_Token添加方法相同</strong></p>
  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">language:</span> <span class="string">node_js</span> <span class="comment"># 设置语言</span></span><br><span class="line"><span class="attr">node_js:</span> <span class="string">stable</span> <span class="comment"># 设置相应版本</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cache:</span></span><br><span class="line"><span class="comment">#     apt: true</span></span><br><span class="line"><span class="comment">#     directories:</span></span><br><span class="line"><span class="comment">#         - node_modules # 缓存不经常更改的内容</span></span><br><span class="line"></span><br><span class="line"><span class="attr">notifications:</span></span><br><span class="line">    <span class="attr">email:</span></span><br><span class="line">        <span class="attr">recipients:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">happyshark520@outlook.com</span></span><br><span class="line">        <span class="attr">on_success:</span> <span class="string">change</span></span><br><span class="line">        <span class="attr">on_failure:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line"><span class="attr">before_install:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">export</span> <span class="string">TZ=&#x27;Asia/Shanghai&#x27;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">hexo-cli</span> <span class="string">-g</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">cheerio</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">chmod</span> <span class="string">+x</span> <span class="string">./publish-to-gh-pages.sh</span></span><br><span class="line"></span><br><span class="line"><span class="attr">install:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">npm</span> <span class="string">install</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">npm</span> <span class="string">i</span> <span class="string">-g</span> <span class="string">yuque-hexo</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">hexo-deployer-git</span> <span class="string">--save</span></span><br><span class="line"></span><br><span class="line"><span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">yuque-hexo</span> <span class="string">clean</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">YUQUE_TOKEN=$&#123;YUQUE_TOKEN&#125;</span> <span class="string">yuque-hexo</span> <span class="string">sync</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">sync</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">hexo</span> <span class="string">clean</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">hexo</span> <span class="string">g</span></span><br><span class="line"></span><br><span class="line"><span class="attr">after_script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">./publish-to-gh-pages.sh</span></span><br><span class="line"></span><br><span class="line"><span class="attr">branches:</span></span><br><span class="line">    <span class="attr">only:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">master</span> <span class="comment">#只监测hexo分支，hexo是我的分支的名称，可根据自己情况设置</span></span><br><span class="line"><span class="attr">env:</span></span><br><span class="line">    <span class="attr">global:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">GH_REF:</span> <span class="string">github.com/HPShark/HPShark.github.io.git</span> <span class="comment">#设置GH_REF，注意更改yourname</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>publish-to-gh-pages.sh：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">set -ev</span><br><span class="line">git clone https://$&#123;GH_REF&#125; .deploy_git</span><br><span class="line">cd .deploy_git</span><br><span class="line">git checkout master</span><br><span class="line">cd ../</span><br><span class="line">mv .deploy_git/.git/ ./public/</span><br><span class="line">cd ./public</span><br><span class="line">git config user.name &quot;HPShark&quot; # 修改name</span><br><span class="line">git config user.email &quot;&lt;github登录邮箱&gt;&quot; # 修改email</span><br><span class="line"># add commit timestamp</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;Travis CI Auto Builder at `date +&quot;%Y-%m-%d %H:%M&quot;`&quot;</span><br><span class="line">git push --force --quiet &quot;https://$&#123;Travis_Token&#125;@$&#123;GH_REF&#125;&quot; master:master</span><br></pre></td></tr></table></figure>
</li>
<li><p>腾讯云serverless函数配置，因为travis-ci.org的网址换成了travis-ci.com，所以要对网上的一些老版本的函数内容中的api部分进行修改，然后再加上token和repos即可</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main_handler</span>(<span class="params"><span class="variable">$event</span>, <span class="variable">$context</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 解析语雀post的数据</span></span><br><span class="line">    <span class="variable">$update_title</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$event</span>-&gt;body)&#123;</span><br><span class="line">        <span class="variable">$yuque_data</span>= json_decode(<span class="variable">$event</span>-&gt;body);</span><br><span class="line">        <span class="variable">$update_title</span> .= <span class="variable">$yuque_data</span>-&gt;data-&gt;title;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// default params</span></span><br><span class="line">    <span class="variable">$repos</span> = <span class="string">&#x27;&#x27;</span>;  <span class="comment">// 用户名%2F源码仓库名，斜杠用%2F代替</span></span><br><span class="line">    <span class="variable">$token</span> = <span class="string">&#x27;&#x27;</span>; <span class="comment">// 你的登录token</span></span><br><span class="line">    <span class="variable">$message</span> = date(<span class="string">&quot;Y/m/d&quot;</span>).<span class="string">&#x27;:yuque update:&#x27;</span>.<span class="variable">$update_title</span>;</span><br><span class="line">    <span class="variable">$branch</span> = <span class="string">&#x27;master&#x27;</span>;</span><br><span class="line">    <span class="comment">// post params</span></span><br><span class="line">    <span class="variable">$queryString</span> = <span class="variable">$event</span>-&gt;queryString;</span><br><span class="line">    <span class="variable">$q_token</span> = <span class="variable">$queryString</span>-&gt;token ? <span class="variable">$queryString</span>-&gt;token : <span class="variable">$token</span>;</span><br><span class="line">    <span class="variable">$q_repos</span> = <span class="variable">$queryString</span>-&gt;repos ? <span class="variable">$queryString</span>-&gt;repos : <span class="variable">$repos</span>;</span><br><span class="line">    <span class="variable">$q_message</span> = <span class="variable">$queryString</span>-&gt;message ? <span class="variable">$queryString</span>-&gt;message : <span class="variable">$message</span>;</span><br><span class="line">    <span class="variable">$q_branch</span> = <span class="variable">$queryString</span>-&gt;branch ? <span class="variable">$queryString</span>-&gt;branch : <span class="string">&#x27;master&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="variable">$q_token</span>);</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&#x27;===&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="variable">$q_repos</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="string">&#x27;===&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="variable">$q_message</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="string">&#x27;===&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="variable">$q_branch</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="string">&#x27;===&#x27;</span>);</span><br><span class="line">    <span class="comment">//request travis ci</span></span><br><span class="line">    <span class="variable">$res_info</span> = triggerTravisCI(<span class="variable">$q_repos</span>, <span class="variable">$q_token</span>, <span class="variable">$q_message</span>, <span class="variable">$q_branch</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$res_code</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$res_message</span> = <span class="string">&#x27;未知&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$res_info</span>[<span class="string">&#x27;http_code&#x27;</span>])&#123;</span><br><span class="line">        <span class="variable">$res_code</span> = <span class="variable">$res_info</span>[<span class="string">&#x27;http_code&#x27;</span>];</span><br><span class="line">        <span class="keyword">switch</span>(<span class="variable">$res_info</span>[<span class="string">&#x27;http_code&#x27;</span>])&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="number">202</span>:</span><br><span class="line">                <span class="variable">$res_message</span> = <span class="string">&#x27;success&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="variable">$res_message</span> = <span class="string">&#x27;faild&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$res</span> = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;status&#x27;</span>=&gt;<span class="variable">$res_code</span>,</span><br><span class="line">        <span class="string">&#x27;message&#x27;</span>=&gt;<span class="variable">$res_message</span></span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* <span class="doctag">@description</span>  travis api , trigger a build</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $repos string 仓库ID、slug</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $token string 登录验证token</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $message string 触发信息</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $branch string 分支</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> $info array 回包信息</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">triggerTravisCI</span> (<span class="params"><span class="variable">$repos</span>, <span class="variable">$token</span>, <span class="variable">$message</span>=<span class="string">&#x27;yuque update&#x27;</span>, <span class="variable">$branch</span>=<span class="string">&#x27;master&#x27;</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//初始化</span></span><br><span class="line">    <span class="variable">$curl</span> = curl_init();</span><br><span class="line">    <span class="comment">//设置抓取的url</span></span><br><span class="line">    curl_setopt(<span class="variable">$curl</span>, CURLOPT_URL, <span class="string">&#x27;https://api.travis-ci.com/repo/&#x27;</span>.<span class="variable">$repos</span>.<span class="string">&#x27;/requests&#x27;</span>);</span><br><span class="line">    <span class="comment">//设置获取的信息以文件流的形式返回，而不是直接输出。</span></span><br><span class="line">    curl_setopt(<span class="variable">$curl</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">    <span class="comment">//设置post方式提交</span></span><br><span class="line">    curl_setopt(<span class="variable">$curl</span>, CURLOPT_CUSTOMREQUEST, <span class="string">&quot;POST&quot;</span>);</span><br><span class="line">    <span class="comment">//设置post数据</span></span><br><span class="line">    <span class="variable">$post_data</span> = json_encode(<span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&quot;request&quot;</span>=&gt; <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&quot;message&quot;</span>=&gt;<span class="variable">$message</span>,</span><br><span class="line">            <span class="string">&quot;branch&quot;</span>=&gt;<span class="variable">$branch</span></span><br><span class="line">        )</span><br><span class="line">    ));</span><br><span class="line">    <span class="variable">$header</span> = <span class="keyword">array</span>(</span><br><span class="line">      <span class="string">&#x27;Content-Type: application/json&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;Travis-API-Version: 3&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;Authorization:token &#x27;</span>.<span class="variable">$token</span>,</span><br><span class="line">      <span class="string">&#x27;Content-Length:&#x27;</span> . strlen(<span class="variable">$post_data</span>)</span><br><span class="line">    );</span><br><span class="line">    curl_setopt(<span class="variable">$curl</span>, CURLOPT_HTTPHEADER, <span class="variable">$header</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$curl</span>, CURLOPT_POSTFIELDS, <span class="variable">$post_data</span>);</span><br><span class="line">    <span class="comment">//执行命令</span></span><br><span class="line">    <span class="variable">$data</span> = curl_exec(<span class="variable">$curl</span>);</span><br><span class="line">    <span class="variable">$info</span> = curl_getinfo(<span class="variable">$curl</span>);</span><br><span class="line">    <span class="comment">//关闭URL请求</span></span><br><span class="line">    curl_close(<span class="variable">$curl</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$info</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="部署过程"><a href="#部署过程" class="headerlink" title="部署过程"></a>部署过程</h3><ol>
<li><p>源码上传至github</p>
<ul>
<li>建一个新的仓库，专门存放源代码（也可以直接在github.io 的那个仓库新建一个分支，不过设置麻烦，就放弃了）</li>
<li>将本地代码上传（可能有信息安全风险，所以建议为博客单独开设一个帐号）。注意仓库要设为公开，travis-ci构建私人仓库是要付费的orz..</li>
</ul>
<p>注意事项：</p>
<ul>
<li><p>上传前建议先执行hexo clean，可以减少上传体积。</p>
</li>
<li><p>也可以通过配置.gitignore控制上传内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.DS_Store</span><br><span class="line">Thumbs.db</span><br><span class="line">db.json</span><br><span class="line">*.log</span><br><span class="line">node_modules/</span><br><span class="line">public/</span><br><span class="line">.deploy*/</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<ol>
<li><p>配置travis-ci</p>
<ul>
<li><p>把.travis.yml和publish-to-gh-pages.sh放在根目录</p>
<ul>
<li><p>登录<a target="_blank" rel="noopener" href="https://travis-ci.com/">travis-ci</a>，绑定github，允许访问github仓库，进入<strong>博客源码</strong>仓库</p>
<p><img src="https://raw.githubusercontent.com/HPShark/blogimages/master/hello-world/travis设置.png" alt=""></p>
</li>
<li><p>设置Environment Variables(环境变量)，设置Travis_Token，YUQUE_TOKEN添加方法类似</p>
<p><img src="https://raw.githubusercontent.com/HPShark/blogimages/master/hello-world/travis的token设置.png" alt=""></p>
</li>
<li><p>配置完成后等待腾讯云serverless触发即可构建，构建成功会return 0，如果有其他问题（一般是缺环境）缺啥在.travis.yml中的install那里npm装包即可~</p>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<ol>
<li><p>腾讯云serverless函数配置：</p>
<ul>
<li><p>新建php空白函数：（可以用python，aqpcet.coding.me用的就是python设置的）</p>
<p><img src="https://raw.githubusercontent.com/HPShark/blogimages/master/hello-world/serverless新建plp文件.png" alt=""></p>
</li>
<li><p>编辑serverless函数内容，需要获取以下两个信息，填入对应的地方就行</p>
<ul>
<li><p>travis登录token，在travis-ci.com中设置界面获取：</p>
<p><img src="https://raw.githubusercontent.com/HPShark/blogimages/master/hello-world/travis登录token.png" alt=""></p>
</li>
<li><p>博客源码的仓库名</p>
<p>现在可以直接用\<github用户名>%2F&lt;博客源码仓库名&gt;代替原来的仓库id了，不用在拿抓包工具抓仓库ID 或 扩展名了</p>
</li>
</ul>
</li>
<li><p>配置触发方式</p>
<p><img src="https://raw.githubusercontent.com/HPShark/blogimages/master/hello-world/serverless设置触发方式.png" alt=""></p>
<p>一般会得到这么个api：<a target="_blank" rel="noopener" href="https://service-s08f6nvk-1251833201.ap-guangzhou.apigateway.myqcloud.com/release/xxx">https://service-s08f6nvk-1251833201.ap-guangzhou.apigateway.myqcloud.com/release/xxx</a></p>
</li>
</ul>
</li>
<li><p>语雀配置：</p>
<p>配置一个仓库的webhook:</p>
<p><img src="https://raw.githubusercontent.com/HPShark/blogimages/master/hello-world/语雀配置.png" alt=""></p>
<p>可以选择所有更新触发或者主动触发，主动触发的意思即发布需要勾选一个选项才会触发webhook。具体可参见语雀文档：<a target="_blank" rel="noopener" href="https://www.yuque.com/yuque/developer/doc-webhook；">https://www.yuque.com/yuque/developer/doc-webhook；</a><br>将serverless生成的api填入,可以在链接后面带参数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">token 登录token</span><br><span class="line">repos 仓库id</span><br><span class="line">message 提交信息</span><br><span class="line">branch 分支</span><br><span class="line"></span><br><span class="line">示例：</span><br><span class="line">https://service-s08f6nvk-1251833201.ap-guangzhou.apigateway.myqcloud.com/release/xxx?repos=xxx&amp;token=xxx&amp;message=xxx&amp;branch=xxx</span><br></pre></td></tr></table></figure>
<p>如果不在链接带参数则写在serverless函数内。</p>
</li>
</ol>
<h3 id="通过语雀插件对front-matter进行处理"><a href="#通过语雀插件对front-matter进行处理" class="headerlink" title="通过语雀插件对front-matter进行处理"></a>通过语雀插件对front-matter进行处理</h3><p>插件地址：<a target="_blank" rel="noopener" href="https://github.com/x-cold/yuque-hexo">https://github.com/x-cold/yuque-hexo</a></p>
<p>需要对package.json，.travis.yml进行配置，在编辑语雀文章时头部要这么写：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tags: [hexo, node]</span><br><span class="line">categories: fe</span><br><span class="line">cover: https://cdn.nlark.com/yuque/0/2019/jpeg/155457/1546857679810-d82e3d46-e960-419c-a715-0a82c48a2fd6.jpeg#align=left&amp;display=inline&amp;height=225&amp;name=image.jpeg&amp;originHeight=225&amp;originWidth=225&amp;size=6267&amp;width=225</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">some description</span><br><span class="line"></span><br><span class="line">&lt;!-- more --&gt;</span><br><span class="line"></span><br><span class="line">more detail</span><br></pre></td></tr></table></figure>
<p>注：冒号后面是<strong>空格</strong>！tags后面必须有中<strong>括号</strong>！有时候同步完之后空格会变成tab造成front-matter无法被插件识别，就会出现front-matter重叠的情况<a target="_blank" rel="noopener" href="https://github.com/x-cold/yuque-hexo/issues/45">issues#45</a></p>
<p><strong>大功告成！在语雀上正常发布一篇文章即可自动触发serverless函数提交给travis-ci构建博客</strong></p>
<h1 id="一些坑"><a href="#一些坑" class="headerlink" title="一些坑"></a>一些坑</h1><h2 id="serverless-python版"><a href="#serverless-python版" class="headerlink" title="serverless python版"></a>serverless python版</h2><p><img src="https://raw.githubusercontent.com/HPShark/blogimages/master/hello-world/serverlesspython版.png" alt=""></p>
<h2 id="私人图床：onedrive"><a href="#私人图床：onedrive" class="headerlink" title="私人图床：onedrive"></a>私人图床：onedrive</h2><p>使用方法非常简单，具体步骤如下：</p>
<ul>
<li><p>注册账户，已有的可直接略过。</p>
</li>
<li><p>登录OneDrive，上传需要外链的图片。</p>
</li>
<li><p>在图片上右键选择“嵌入”按钮，再在弹出的窗口中点击“生成”选项。</p>
</li>
<li><p>将链接复制到需要展示的地方。</p>
</li>
</ul>
<p>来自 <a target="_blank" rel="noopener" href="https://osk.ink/archives/12/">https://osk.ink/archives/12/</a> </p>
<h2 id="travis渲染时报错："><a href="#travis渲染时报错：" class="headerlink" title="travis渲染时报错："></a>travis渲染时报错：</h2><blockquote>
<p>travis /bin/bash^M: bad interpreter: No such file or directory</p>
<p>If you use <strong>Sublime Text</strong> on Windows or Mac to edit your scripts:</p>
<p>Click on View &gt; Line Endings &gt; Unix and <strong>save</strong> the file again.</p>
</blockquote>
<p>原因：编码问题，如下解决即可</p>
<p><img src="https://raw.githubusercontent.com/HPShark/blogimages/master/hello-world/travis编码报错解决.png" alt=""></p>
<h2 id="Ubuntu安装Proxychains"><a href="#Ubuntu安装Proxychains" class="headerlink" title="Ubuntu安装Proxychains"></a>Ubuntu安装Proxychains</h2><p>Proxychains是Linux上一款全局代理工具，通过Hook Socket函数实现透明代理，这和Windows上的Proxifier有点类似。 在Ubuntu上安装Proxychains的方法是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install proxychains </span><br></pre></td></tr></table></figure>
<p>安装的是3.1版本，配置文件的路径是：/etc/proxychains.conf，内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"># proxychains.conf  VER 3.1</span><br><span class="line">#</span><br><span class="line">#        HTTP, SOCKS4, SOCKS5 tunneling proxifier with DNS.</span><br><span class="line">#</span><br><span class="line"># The option below identifies how the ProxyList is treated.</span><br><span class="line"># only one option should be uncommented at time,</span><br><span class="line"># otherwise the last appearing option will be accepted</span><br><span class="line">#</span><br><span class="line">#dynamic_chain</span><br><span class="line">#</span><br><span class="line"># Dynamic - Each connection will be done via chained proxies</span><br><span class="line"># all proxies chained in the order as they appear in the list</span><br><span class="line"># at least one proxy must be online to play in chain</span><br><span class="line"># (dead proxies are skipped)</span><br><span class="line"># otherwise EINTR is returned to the app</span><br><span class="line">#</span><br><span class="line">strict_chain</span><br><span class="line">#</span><br><span class="line"># Strict - Each connection will be done via chained proxies</span><br><span class="line"># all proxies chained in the order as they appear in the list</span><br><span class="line"># all proxies must be online to play in chain</span><br><span class="line"># otherwise EINTR is returned to the app</span><br><span class="line">#</span><br><span class="line">#random_chain</span><br><span class="line">#</span><br><span class="line"># Random - Each connection will be done via random proxy</span><br><span class="line"># (or proxy chain, see  chain_len) from the list.</span><br><span class="line"># this option is good to test your IDS :)</span><br><span class="line"># Make sense only if random_chain</span><br><span class="line">#chain_len = 2</span><br><span class="line"># Quiet mode (no output from library)</span><br><span class="line">#quiet_mode</span><br><span class="line"># Proxy DNS requests - no leak for DNS data</span><br><span class="line">proxy_dns </span><br><span class="line"># Some timeouts in milliseconds</span><br><span class="line">tcp_read_time_out 15000</span><br><span class="line">tcp_connect_time_out 8000</span><br><span class="line"># ProxyList format</span><br><span class="line">#       type  host  port [user pass]</span><br><span class="line">#       (values separated by &#x27;tab&#x27; or &#x27;blank&#x27;)</span><br><span class="line">#</span><br><span class="line">#</span><br><span class="line">#        Examples:</span><br><span class="line">#</span><br><span class="line">#               socks5  192.168.67.78   1080    lamer   secret</span><br><span class="line">#               http    192.168.89.3    8080    justu   hidden</span><br><span class="line">#               socks4  192.168.1.49    1080</span><br><span class="line">#               http    192.168.39.93   8080</span><br><span class="line">#</span><br><span class="line">#</span><br><span class="line">#       proxy types: http, socks4, socks5</span><br><span class="line">#        ( auth types supported: &quot;basic&quot;-http  &quot;user/pass&quot;-socks )</span><br><span class="line">#</span><br><span class="line">[ProxyList]</span><br><span class="line"># add proxy here ...</span><br><span class="line"># meanwile</span><br><span class="line"># defaults set to &quot;tor&quot;</span><br><span class="line">socks4         127.0.0.1 9050</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Proxychains支持HTTP（HTTP-Connect）、SOCKS4和SOCKS5三种类型的代理，需要注意的是：配置代理服务器只能使用ip地址，不能使用域名，否则会连不上。</p>
<p>Proxychains支持3种模式： </p>
<ol>
<li>动态模式 按照配置的代理顺序连接，不存活的代理服务器会被跳过 </li>
<li>严格模式     按照配置的代理顺序连接，必须保证所有代理服务器都是存活的，否则会连接失败 </li>
<li>随机模式     随机选择一台代理服务器连接，也可以使用代理链</li>
</ol>
<p>如果不需要代理DNS的话，可以注释掉proxy_dns这行。</p>
<p>使用的时候在命令行前加上proxychains即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu-pc:~# proxychains telnet [www.baidu.com](http://www.baidu.com) 80 ProxyChains-3.1 ([http://proxychains.sf.net](http://proxychains.sf.net/)) Trying 14.215.177.37… |R-chain|-&lt;&gt;-10.0.0.10:8080-&lt;&gt;&lt;&gt;-14.215.177.37:80-&lt;&gt;&lt;&gt;-OK Connected to [www.a.shifen.com](http://www.a.shifen.com). Escape character is ‘^]’. </span><br><span class="line"></span><br><span class="line">proxychains命令其实是个脚本文件，内容如下：</span><br><span class="line"></span><br><span class="line">\#!/bin/sh</span><br><span class="line"> echo &quot;ProxyChains-3.1 (http://proxychains.sf.net)&quot;</span><br><span class="line"> if [ $# = 0 ] ; then</span><br><span class="line">     echo &quot; usage:&quot;</span><br><span class="line">     echo &quot;     proxychains &lt;prog&gt; [args]&quot;</span><br><span class="line">     exit</span><br><span class="line"> fi</span><br><span class="line"> export LD_PRELOAD=libproxychains.so.3</span><br><span class="line"> exec &quot;$@&quot;</span><br></pre></td></tr></table></figure>
<p>它的目的是设置LD_PRELOAD环境变量，以便创建的新进程会加载libproxychains.so.3，这个so的作用是Hook Socket函数。因此，也可以在当前shell中执行： </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export LD_PRELOAD=libproxychains.so.3</span><br></pre></td></tr></table></figure>
<p>这样之后执行的命令都会使用代理访问。</p>
<p>不过这个版本有个问题，配置代理后所有的连接都会走代理，包括对回环地址的访问。这并不是我们所期望的，幸好有个版本提供了解决方案。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/rofl0r/proxychains cd proxychains ./configure make make install </span><br></pre></td></tr></table></figure>
<p>安装后在配置文件中加入：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localnet 127.0.0.0/255.0.0.0 </span><br></pre></td></tr></table></figure>
<p>安装后的命令是proxychains4，因此可以和旧版本命令并存。这样对于回环地址就可以绕过代理，使用直连了。</p>
<p>相对于Proxifier而言，这种方式还是弱了一点，毕竟有时候我们还是需要根据不同的情况使用不同的代理服务器。</p>
<h2 id="有东西传不到github上去？"><a href="#有东西传不到github上去？" class="headerlink" title="有东西传不到github上去？"></a>有东西传不到github上去？</h2><p>删掉.deploy_git:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- rm -rf .deploy_git/</span><br></pre></td></tr></table></figure>
<h2 id="语雀防盗链解决办法："><a href="#语雀防盗链解决办法：" class="headerlink" title="语雀防盗链解决办法："></a>语雀防盗链解决办法：</h2><p>临时方案是直接在 html 模版中添加 head 进行绕过</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;referrer&quot;</span> <span class="attr">content</span>=<span class="string">&quot;no-referrer&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p> (来自 <a target="_blank" rel="noopener" href="https://github.com/x-cold/yuque-hexo/issues/41">https://github.com/x-cold/yuque-hexo/issues/41</a> )</p>
<p>注：对于butterfly主题的话对themes\Butterfly\layout\includes\layout.pug修改head部分即可，但是会造成网站访客数和文章阅读数无法加载</p>
<h2 id="gem失败"><a href="#gem失败" class="headerlink" title="gem失败"></a>gem失败</h2><p>apt-get install ruby-dev </p>
<h2 id="Windows-的-Linux-子系统的文件同步和-Windows-不是实时的问题"><a href="#Windows-的-Linux-子系统的文件同步和-Windows-不是实时的问题" class="headerlink" title="Windows 的 Linux 子系统的文件同步和 Windows 不是实时的问题"></a>Windows 的 Linux 子系统的文件同步和 Windows 不是实时的问题</h2><p>如果使用windows子系统的Ubuntu的话，可能会出现Windows 的 Linux 子系统的文件同步和 Windows 不是实时的问题（来自 <a target="_blank" rel="noopener" href="https://www.zhihu.com/question/318832524/answer/641951256">https://www.zhihu.com/question/318832524/answer/641951256</a> ）</p>
<p>你可以在Windows下存储文件，然后在wsl中使用/mnt/盘符/路径 访问</p>
<p>你也可以在1903更新发布后在Linux rootfs中存储文件，Windows程序使用\wsl$\Ubuntu\unix路径 访问</p>
<p>唯独不正确的操作是找到AppData里rootfs文件夹直接用Windows程序修改，因为这里面的文件在NTFS中除了存储文件内容，Windows文件元数据，还存储unix文件元数据（比如rwx权限，unix用户组和用户），你创建的文件并不具有这样的属性，因此会导致权限混乱。</p>
<p>详见：<a href="https://link.zhihu.com/?target=https%3A//blogs.msdn.microsoft.com/commandline/2016/11/17/do-not-change-linux-files-using-windows-apps-and-tools/">https://blogs.msdn.microsoft.com/commandline/2016/11/17/do-not-change-linux-files-using-windows-apps-and-tools/</a></p>
<p>1903（19H1，20195月更新）的改动</p>
<p><strong>Linux Files inside of File Explorer</strong></p>
<p>The best way to get started with this feature is to open your Linux files in File Explorer! To do this, open your favorite distro, make sure your current folder is your Linux home directory, and type in:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explorer.exe .</span><br></pre></td></tr></table></figure>
<p>来自 <a target="_blank" rel="noopener" href="https://devblogs.microsoft.com/commandline/whats-new-for-wsl-in-windows-10-version-1903/">https://devblogs.microsoft.com/commandline/whats-new-for-wsl-in-windows-10-version-1903/</a> </p>
<h2 id="npm淘宝源的问题"><a href="#npm淘宝源的问题" class="headerlink" title="npm淘宝源的问题"></a>npm淘宝源的问题</h2><p>这玩意有毛病，经常会出奇奇怪怪的bug，最好的方式还是挂代理</p>
<p>C盘用户文件夹下的.npmrc</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">proxy=http://127.0.0.1:1081</span><br><span class="line">https-proxy=http://127.0.0.1:1081/</span><br></pre></td></tr></table></figure>
<h2 id="github-action错误提示"><a href="#github-action错误提示" class="headerlink" title="github action错误提示"></a>github action错误提示</h2><blockquote>
<p>How to fix ‘Unsupported platform for fsevents@1.2.9: wanted {“os”:”darwin”,”arch”:”any”} (current: {“os”:”win32”,”arch”:”x64”})</p>
</blockquote>
<p>解决办法：</p>
<ul>
<li><p>在deploy.yml中添加          </p>
<p><code>npm i -f</code></p>
</li>
</ul>
<h1 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h1><ul>
<li><p>[语雀+TravisCI+Serverless]: <a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000017797561">https://segmentfault.com/a/1190000017797561</a></p>
</li>
<li><p>[【持续更新】最全Hexo博客搭建+主题优化+插件配置+常用操作+错误分析]: <a target="_blank" rel="noopener" href="https://www.simon96.online/2018/10/12/hexo-tutorial/">https://www.simon96.online/2018/10/12/hexo-tutorial/</a></p>
</li>
<li><p>[使用Travis CI自动部署Hexo博客]: <a target="_blank" rel="noopener" href="https://www.itfanr.cc/2017/08/09/using-travis-ci-automatic-deploy-hexo-blogs/">https://www.itfanr.cc/2017/08/09/using-travis-ci-automatic-deploy-hexo-blogs/</a></p>
</li>
<li><p>[hexo-theme-butterfly安裝文檔]: <a target="_blank" rel="noopener" href="https://jerryc.me/posts/21cfbf15/">https://jerryc.me/posts/21cfbf15/</a></p>
</li>
<li><p>[Hexo 博客终极玩法：云端写作，自动部署]: <a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000017797561">https://segmentfault.com/a/1190000017797561</a></p>
</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">HPShark</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.happyshark.cn/2019/12/26/hello-world/">https://www.happyshark.cn/2019/12/26/hello-world/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.happyshark.cn" target="_blank">Happy Shark</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/hexo/">hexo</a><a class="post-meta__tags" href="/tags/travis-CI/">travis CI</a><a class="post-meta__tags" href="/tags/serverless/">serverless</a><a class="post-meta__tags" href="/tags/%E8%AF%AD%E9%9B%80/">语雀</a></div><div class="post_share"><div class="social-share" data-image="https://qjtsaw.ch.files.1drv.com/y4mpMLII6Wtosqm5wWqSXPsGV1cu9oGQFY9odVJFGOxTdiN8c6FvJnIoHpEIfIt7RiEFrhRMqtfAvwmWCbWKBe3t3aT4DH_JvOOqeDzKQVsUUyhcb6lWIAcaFY4qZew4qh7PY060s8urZiFhrwDDbnzTFXykibC71Aap10ceNza_bkL84zoNkY0AKGhzGSZVYjf4xY_6S7eb0YCfuN4I_mG7Q?width=906&amp;height=966&amp;cropmode=none" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2020/01/20/%E6%9A%B4%E5%8A%9B%E6%8F%90%E5%8D%87%E7%BD%91%E9%80%9F%E2%80%94%E2%80%94%E5%A4%9A%E6%8B%A8/"><img class="prev-cover" src="https://ppqcdg.ch.files.1drv.com/y4m9MMd6JTL3Z9bm_49dB-fmZbIjxnJCJ7qdF14Q8UPo0_2TD4_gT_ZFunSr_Q67ribivOgpkJSJdqW-idtqkuKJK0IrxCD7VJLTftdrnW0Z6iUUV9D8xROGkQnffOoWAHHOmtmJ171_FIBiaPsixkJy_RzgNijckg_THurGP_ZwdsGkPgX_29DxOWvA3P1kHL8yyEGt2giY5WObViUvX4nGw?width=1071&amp;height=581&amp;cropmode=none" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/hexo/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">修改WIFI名称&amp;暴力多拨提升网速</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/05/22/travis-ci在Node.js-v14.0下自动构建hexo报错/" title="travis-ci在Node.js v14.0下自动构建hexo报错"><img class="cover" src="https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/node14bug/编译错误.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-22</div><div class="title">travis-ci在Node.js v14.0下自动构建hexo报错</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/hexo/avatar.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/hexo/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">HPShark</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HPShark"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:happyshark520@outlook.com" target="_blank" title="Email"><i class="fa fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">感谢访问，欢迎交换友链~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2"><span class="toc-number">1.</span> <span class="toc-text">部署</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89%E9%85%8D%E7%BD%AEgit"><span class="toc-number">1.1.</span> <span class="toc-text">（可选）配置git</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-Node-js%E5%92%8Cnpm"><span class="toc-number">1.2.</span> <span class="toc-text">安装 Node.js和npm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-Hexo"><span class="toc-number">1.3.</span> <span class="toc-text">安装 Hexo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6"><span class="toc-number">1.4.</span> <span class="toc-text">安装插件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E5%AE%89%E8%A3%85%E6%88%90%E5%8A%9F"><span class="toc-number">1.5.</span> <span class="toc-text">测试安装成功</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%8C%E6%AD%A5%E5%88%B0githubpages"><span class="toc-number">2.</span> <span class="toc-text">同步到githubpages</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%A1%88%E4%B8%80%EF%BC%9AGithubPages"><span class="toc-number">2.1.</span> <span class="toc-text">方案一：GithubPages</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%A1%88%E4%BA%8C%EF%BC%9AGithubPages-%E5%9F%9F%E5%90%8D"><span class="toc-number">2.2.</span> <span class="toc-text">方案二：GithubPages + 域名</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%BB%E9%A2%98%EF%BC%8C%E6%8F%92%E4%BB%B6%E9%85%8D%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text">主题，插件配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E9%A2%98"><span class="toc-number">3.1.</span> <span class="toc-text">主题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%92%E4%BB%B6"><span class="toc-number">3.2.</span> <span class="toc-text">插件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#live2d"><span class="toc-number">3.2.1.</span> <span class="toc-text">live2d</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%84%E8%AE%BA%E6%8F%92%E4%BB%B6%EF%BC%882021%E5%B9%B49%E6%9C%8812%E6%97%A5%E6%9B%B4%E6%96%B0%EF%BC%89"><span class="toc-number">3.2.2.</span> <span class="toc-text">评论插件（2021年9月12日更新）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E9%98%B6%E9%85%8D%E7%BD%AE"><span class="toc-number">4.</span> <span class="toc-text">进阶配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#github-actions%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%EF%BC%882021%E5%B9%B49%E6%9C%8812%E6%97%A5%E6%9B%B4%E6%96%B0%EF%BC%89"><span class="toc-number">4.1.</span> <span class="toc-text">github actions自动构建（2021年9月12日更新）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%AD%E9%9B%80%E4%BA%91%E7%AB%AF%E5%86%99%E4%BD%9C-%E8%85%BE%E8%AE%AF%E4%BA%91serverless%E6%8F%90%E4%BA%A4-Travis-ci%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA-github-pages%E5%8F%91%E5%B8%83"><span class="toc-number">4.2.</span> <span class="toc-text">语雀云端写作+腾讯云serverless提交+ Travis-ci自动构建+github-pages发布</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E6%96%87%E4%BB%B6%EF%BC%9A"><span class="toc-number">4.2.1.</span> <span class="toc-text">关键文件：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2%E8%BF%87%E7%A8%8B"><span class="toc-number">4.2.2.</span> <span class="toc-text">部署过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E8%AF%AD%E9%9B%80%E6%8F%92%E4%BB%B6%E5%AF%B9front-matter%E8%BF%9B%E8%A1%8C%E5%A4%84%E7%90%86"><span class="toc-number">4.2.3.</span> <span class="toc-text">通过语雀插件对front-matter进行处理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E5%9D%91"><span class="toc-number">5.</span> <span class="toc-text">一些坑</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#serverless-python%E7%89%88"><span class="toc-number">5.1.</span> <span class="toc-text">serverless python版</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A7%81%E4%BA%BA%E5%9B%BE%E5%BA%8A%EF%BC%9Aonedrive"><span class="toc-number">5.2.</span> <span class="toc-text">私人图床：onedrive</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#travis%E6%B8%B2%E6%9F%93%E6%97%B6%E6%8A%A5%E9%94%99%EF%BC%9A"><span class="toc-number">5.3.</span> <span class="toc-text">travis渲染时报错：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ubuntu%E5%AE%89%E8%A3%85Proxychains"><span class="toc-number">5.4.</span> <span class="toc-text">Ubuntu安装Proxychains</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%89%E4%B8%9C%E8%A5%BF%E4%BC%A0%E4%B8%8D%E5%88%B0github%E4%B8%8A%E5%8E%BB%EF%BC%9F"><span class="toc-number">5.5.</span> <span class="toc-text">有东西传不到github上去？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%AD%E9%9B%80%E9%98%B2%E7%9B%97%E9%93%BE%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%EF%BC%9A"><span class="toc-number">5.6.</span> <span class="toc-text">语雀防盗链解决办法：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gem%E5%A4%B1%E8%B4%A5"><span class="toc-number">5.7.</span> <span class="toc-text">gem失败</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Windows-%E7%9A%84-Linux-%E5%AD%90%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%96%87%E4%BB%B6%E5%90%8C%E6%AD%A5%E5%92%8C-Windows-%E4%B8%8D%E6%98%AF%E5%AE%9E%E6%97%B6%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">5.8.</span> <span class="toc-text">Windows 的 Linux 子系统的文件同步和 Windows 不是实时的问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#npm%E6%B7%98%E5%AE%9D%E6%BA%90%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">5.9.</span> <span class="toc-text">npm淘宝源的问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#github-action%E9%94%99%E8%AF%AF%E6%8F%90%E7%A4%BA"><span class="toc-number">5.10.</span> <span class="toc-text">github action错误提示</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%EF%BC%9A"><span class="toc-number">6.</span> <span class="toc-text">参考：</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/10/21/Linux%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C/" title="Linux命令手册"><img src="https://qjtraw.ch.files.1drv.com/y4md3Es6ur1RCQqiuZN1FeK15oSbIDYU_SbIzh4R-KLgB2fOjMYvxVQ2bWoTwCEHOldW1N8zDD5G-bGJMn7nkfoIAo8irx31My-68nx7s7D17-aFGuZcXiIXgJ8RsIcOdwTrfyYx8ldelgdBsLODwJM6lwoMTk2evTn1xrLFpeTpS3W1O4Wca36Gida0VfMcltaXxuSyq4iuo7fhFXfaY5JJQ?width=908&amp;height=1024&amp;cropmode=none" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/hexo/404.jpg'" alt="Linux命令手册"/></a><div class="content"><a class="title" href="/2021/10/21/Linux%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C/" title="Linux命令手册">Linux命令手册</a><time datetime="2021-10-21T04:00:00.000Z" title="发表于 2021-10-21 12:00:00">2021-10-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/16/Win1011%E7%BD%91%E7%BB%9C%E6%96%AD%E8%BF%9E%EF%BC%8C%E6%97%A0%E7%BD%91%E7%BB%9C%E5%8E%9F%E5%9B%A0%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" title="Win10/11 网络断连，无网络原因及解决方法"><img src="https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/win10无网络/20211016114109.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/hexo/404.jpg'" alt="Win10/11 网络断连，无网络原因及解决方法"/></a><div class="content"><a class="title" href="/2021/10/16/Win1011%E7%BD%91%E7%BB%9C%E6%96%AD%E8%BF%9E%EF%BC%8C%E6%97%A0%E7%BD%91%E7%BB%9C%E5%8E%9F%E5%9B%A0%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" title="Win10/11 网络断连，无网络原因及解决方法">Win10/11 网络断连，无网络原因及解决方法</a><time datetime="2021-10-16T04:00:00.000Z" title="发表于 2021-10-16 12:00:00">2021-10-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/15/%E5%B8%B8%E8%A7%81%E7%BB%8F%E5%85%B8%E7%AE%97%E6%B3%95AND%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/" title="常见经典算法AND背包问题"><img src="https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/常见经典算法/20211015211402.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/hexo/404.jpg'" alt="常见经典算法AND背包问题"/></a><div class="content"><a class="title" href="/2021/10/15/%E5%B8%B8%E8%A7%81%E7%BB%8F%E5%85%B8%E7%AE%97%E6%B3%95AND%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/" title="常见经典算法AND背包问题">常见经典算法AND背包问题</a><time datetime="2021-10-15T13:00:00.000Z" title="发表于 2021-10-15 21:00:00">2021-10-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/12/%E5%AE%89%E5%85%A8%E8%A7%84%E7%BA%A6%E7%AC%AC%E4%B8%80%E8%AE%B2/" title="安全规约第一讲"><img src="https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/安全规约第一讲/20211012125638.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/hexo/404.jpg'" alt="安全规约第一讲"/></a><div class="content"><a class="title" href="/2021/10/12/%E5%AE%89%E5%85%A8%E8%A7%84%E7%BA%A6%E7%AC%AC%E4%B8%80%E8%AE%B2/" title="安全规约第一讲">安全规约第一讲</a><time datetime="2021-10-12T04:00:00.000Z" title="发表于 2021-10-12 12:00:00">2021-10-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/02/%E5%BC%80%E6%9C%BA%E6%89%A7%E8%A1%8Cpython%E8%84%9A%E6%9C%AC%E8%87%AA%E5%8A%A8%E7%99%BB%E5%BD%95SNNU%E6%A0%A1%E5%9B%AD%E7%BD%91/" title="开机执行python脚本自动登录SNNU校园网"><img src="https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/登录snnu/20211002200835.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/HPShark/blogimages@master/hexo/404.jpg'" alt="开机执行python脚本自动登录SNNU校园网"/></a><div class="content"><a class="title" href="/2021/10/02/%E5%BC%80%E6%9C%BA%E6%89%A7%E8%A1%8Cpython%E8%84%9A%E6%9C%AC%E8%87%AA%E5%8A%A8%E7%99%BB%E5%BD%95SNNU%E6%A0%A1%E5%9B%AD%E7%BD%91/" title="开机执行python脚本自动登录SNNU校园网">开机执行python脚本自动登录SNNU校园网</a><time datetime="2021-10-02T13:00:00.000Z" title="发表于 2021-10-02 21:00:00">2021-10-02</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2016 - 2021 By HPShark</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">有问题为什么不问问神奇的海螺呢？</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      true && mermaid.init()
    })
  }
}</script><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '3807eabd8b9ece23bfda',
      clientSecret: '29e9df6640a6999b028beaaedaa76133860a1f53',
      repo: 'blogcomment',
      owner: 'HPShark',
      admin: ['HPShark'],
      id: '5117e41aea5218239a1e2fe7f9c68b00',
      language: 'zh-CN',
      perPage: 10,
      distractionFreeMode: false,
      pagerDirection: 'last',
      createIssueManually: false,
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const findTrueUrl = (array) => {
    Promise.all(array.map(item =>
      fetch(item.url).then(resp => resp.json()).then(data => {
        const urlArray = data.body.match(/(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?/ig)
        if (data.user.login === 'utterances-bot') {
          return urlArray.pop()
        } else {
          return urlArray.shift()
        }
      })
    )).then(res => {
        array = array.map((i,index)=> {
          return {
            ...i,
            url: res[index]
          }
        })

        saveToLocal.set('github-newest-comments', JSON.stringify(array), 10/(60*24))
        generateHtml(array)
    });
  }

  const getComment = () => {
    fetch('https://api.github.com/repos/HPShark/blogcomment/issues/comments?sort=updated&direction=desc&per_page=6&page=1',{
      "headers": {
        Accept: 'application/vnd.github.v3.html+json'
      }
    })
      .then(response => response.json())
      .then(data => {
        const githubArray = data.map(item => {
          return {
            'avatar': item.user.avatar_url,
            'content': changeContent(item.body_html),
            'nick': item.user.login,
            'url': item.issue_url,
            'date': item.updated_at,
            'githubUrl': item.html_url
          }
        })
        findTrueUrl(githubArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "无法获取评论，请确认相关配置是否正确"
      })
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('github-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><div class="aplayer no-destroy" data-id="8161894762" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="true" data-text="计算机,豆浆机,榨汁机,传真机,汽轮机,内燃机,灭火机,掘土机,扩音机,截击机,教练机,舰载机,录音机,録音机,录像机,录影机,留声机,离心机,老虎机,冷冻机,歼击机,交换机,鼓风机,轰炸机,滑翔机,发电机,放映机,法郎机,发动机,反潜机,发报机,缝纫机,复印机,锅驼机,滚齿机,油印机,永动机,轧道机,轧钢机,凿岩机,运输机,榨油机,轧染机,战斗机,直升机,织布机,制冷机,照相机,侦察机,装载机,缫丝机,坐飞机,钻探机,钻井机,涡轮机,洗衣机,压路机,压缩机,旋翼机,压力机,心肺机,扬谷机,预警机,曳引机,速印机,通风机,透平机,送风机,拖拉机,推土机,脱粒机,小军机,寻呼机,打桩机,打印机,打字机,打火机,电话机,铲土机,柴油机,吹风机,耳塞机,电唱机,电报机,杜德机,电视机,电动机,对撞机,对讲机,放像机,动力机,订书机,铲运机,步谈机,报话机,步话机,播种机,伞翼机,扇风机,扫除机,爆炸机,收报机,摄像机,收录机,收音机,升降机,视盘机,升船机,说兵机,水轮机,顺风机,水上飞机,收发信机,数码相机,数字相机,生态危机,审势相机,暗藏杀机,傻里巴机,傻里八机,白费心机,剥复之机,财政危机,不失时机,持重待机,犯罪动机,喘息之机,东条英机,倒纻翻机,错过时机,枉费心机,枉用心机,微特电机,天赐良机,通险畅机,随物应机,贻误军机,一日万机,一线生机,斜翼飞机,泄露天机,鸭式飞机,泄漏天机,袖里玄机,坐失事机,坐失良机,走漏天机,运策决机,用尽心机,语不投机,光计算机,购买动机,观变沉机,工作母机,费尽心机,反潜飞机,话不投机,航天飞机,火箭飞机,活泼天机,漏泄天机,可乘之机,静不露机,经济危机,决胜之机,将机就机,空天飞机,军用飞机,鸥鸟忘机,妙算神机,鸥鹭忘机,日理万机,燃气轮机,施关发机,日有万机,煞费心机,全天候飞机,汽轮发电机,喷气式飞机,喷气发动机,联合收割机,卡式录音机,绝热发动机,空气压缩机,空中加油机,火箭发动机,轮式拖拉机,活塞式飞机,航空发动机,海军轰炸机,反潜直升机,分时计算机,异步发电机,异步电动机,直流发电机,直流电动机,中央处理机,中华学习机,专用计算机,自动取款机,自动柜员机,武装直升机,亚声速飞机,外围处理机,同步电动机,通用计算机,同步发电机,网络计算机,微型计算机,电影放映机,电影摄影机,电视摄影机,单板计算机,调频收音机,电子计算机,电视接收机,电子游戏机,超声速飞机,实时计算机,手扶拖拉机,水轮发电机,数据流计算机,变后掠翼飞机,电子对抗飞机,无人驾驶飞机,混凝土搅拌机,工业用拖拉机,混凝土振捣机,履带式拖拉机,控制流计算机,空气喷气发动机,卡拉ok伴唱机,涡轮螺旋桨飞机,单片微型计算机,电子数字计算机,电子模拟计算机,第三代电子计算机,第四代电子计算机,第五代电子计算机,第一代电子计算机,第二代电子计算机,活塞式航空发动机,混合式电子计算机,难得者时，易失者机,垂直和短距起落飞机,善观风色，善择时机,双水内冷汽轮发电机" data-fontsize="15px" data-random="false" async="async"></script><script>((window.gitter = {}).chat = {}).options = {
  disableDefaultChat: true,
};
document.addEventListener('gitter-sidecar-ready', (e) => {
  const GitterChat = e.detail.Chat
  let chat

  function initGitter () {
    chat = new GitterChat({
      room: 'happysharkroom/community',
      activationElement: '#chat_btn'
    });
  }

  initGitter()

  if (true) {
    document.addEventListener('pjax:complete', () => {
      chat.destroy()
      initGitter()
    })
  }

})</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="async" defer="defer"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.removeEventListener('scroll', window.tocScrollFn)
  window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'UA-116830180-1', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (true) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":120,"height":240},"mobile":{"show":true}});</script></body></html>